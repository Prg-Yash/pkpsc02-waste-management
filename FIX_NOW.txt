#!/bin/bash
# CRITICAL FIX - Your app is using old .env values!

echo "ğŸ”´ PROBLEM DETECTED:"
echo "Your app shows: API_URL: http://192.168.31.216:3000"
echo "But .env has: https://faa290152dbb.ngrok-free.app"
echo ""
echo "This means Expo cached the old .env and didn't reload!"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸš¨ SOLUTION - Follow these steps EXACTLY:"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "1ï¸âƒ£  STOP your current Expo server (Ctrl+C)"
echo ""
echo "2ï¸âƒ£  DELETE the .expo folder:"
echo "   cd app"
echo "   Remove-Item -Recurse -Force .expo"
echo ""
echo "3ï¸âƒ£  RESTART Expo with tunnel:"
echo "   npx expo start -c --tunnel"
echo ""
echo "4ï¸âƒ£  Wait for QR code and scan it"
echo ""
echo "5ï¸âƒ£  Try submitting waste again"
echo ""
echo "6ï¸âƒ£  Check logs - should show:"
echo "   API_URL: https://faa290152dbb.ngrok-free.app"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“Œ WHY THIS HAPPENS:"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "- Expo caches environment variables"
echo "- Changing .env doesn't auto-reload"
echo "- Must use -c flag to clear cache"
echo "- Tunnel mode needed since local network fails"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "âœ… VERIFICATION:"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "After restarting, you should see in console:"
echo "ğŸ”µ Starting waste submission..."
echo "API_URL: https://faa290152dbb.ngrok-free.app  â† CORRECT!"
echo ""
echo "If you still see http://192.168.31.216:3000,"
echo "then .expo cache wasn't cleared properly."
echo ""
